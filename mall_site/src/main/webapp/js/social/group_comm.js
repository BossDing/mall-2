var agreementFlag=true;var addCount=1;$(document).ready(function(){var customerId=$("#customerid").val();if(customerId){$("#my_group").show();$("#mymanager").attr("href","myjoinedgroup.html?groupCreateAuthorId="+customerId);$("#nologin").hide();$("#login").show()}else{$("nologin").show();$("login").hide();$("#my_group").hide()}});function changeChineseChar(str){var r="%uFF0C";if((escape(str)).match(r)){str=unescape(escape(str).replace(/%uFF0C/g,"%2C"))}return str}var labelFlag=true;function checkLabel(){var arr=new Array();var label=$("#groupLabel").val();label=changeChineseChar(label);var reg=/^[\da-zA-Z\u4E00-\u9FA5]{1,10}$/;if(label!=""){arr=label.split(",");if(arr.length>5){alert("最多5个字符,以','分隔!");labelFlag=false}else{labelFlag=true}for(var i=0;i<arr.length;i++){if(!reg.test(arr[i])){alert("标签由数字、字母、汉子组成限制10个字符");labelFlag=false}}}}function creategroup(){window.open("togroupcreate.html","","")}var nameLengthFlag=true;function textLimt(thisArea,maxLength){if(thisArea.type=="text"){if(thisArea.value.length>maxLength){$("#namelength").show();$("#namelimit").html("长度不能超过 15 字!");nameLengthFlag=false}else{$("#namelength").hide();nameLengthFlag=true}}else{if(thisArea.type=="textarea"){$("#remarklimit").html("简介不得超过500个字，你还可以输入");$("#num").show();$("#num").html(maxLength-thisArea.value.length);return true}}}function checkSpecSymb(inputobj,Tipobj){var regexp=new RegExp("[`~!@#$^&*()={}':;',\\[\\]<>/?~！@#￥……&*（）{}【】‘；：”“'。，、？]");if(regexp.test($("#"+inputobj).val())){$("#"+Tipobj).html("输入的内容包含特殊字符!");$("#"+inputobj).focus();return false}else{return true}}function changeHead(){if($("#upload").val()==""){$("#groupHead").show();$("#headgroup").hide();flag=false&&flag}else{$("#headgroup").show();$("#groupHead").hide()}}function create(flag){var flag=true;if($("#groupName").val()==""){$("#namelimit").html("小组名称不能为空!");$("#namelength").show();$("#groupName").focus();flag=false&&flag}else{flag=nameLengthFlag&&flag}if($("#upload").val()==""){$("#groupHead").show();$("#headgroup").hide();flag=false&&flag}else{$("#headgroup").show();$("#groupHead").hide()}if($("#groupRemark").val()==""){$("#remarklimit").html("小组简介不能为空");$("#num").hide();if($("#groupName").val()!=""){$("#groupRemark").focus()}flag=false&&flag}if(flag!=1){checkLabel()}if(flag&&agreementFlag&&labelFlag){$("#creategroup").form("submit",{type:"post",url:"savegroup.html",async:false,onSubmit:function(){return $(this).form("validate")},success:function(result){if(result>0){$("#remarklength").hide();$("#successDialog").show()}if(result<0){alert("头像大小超过2M")}}})}}function addGroup(tid,gid){if(addCount==1){addCount++}else{return}params="limitAddType="+tid+"&groupId="+gid;$.ajax({type:"post",url:"addgroup.html?"+params,async:false,success:function(data){if(data==1){var pageNo=$("#page").val();page(pageNo)}else{if(data==-1){$("#message").html("加入请求已经发出,请等待管理员审核！");dia1(1)}else{if(data==-2){$("#message").html("该小组拒绝该用户加入,请联系管理员！");dia1(1)}else{if(data==0){$("#message").html("此小组不允许任何人加入！");dia1(1)}else{window.location.href=data}}}}}})}function outGroup(cid,gid){var param="customerId="+cid+"&groupId="+gid;if(confirm("你确定要退出此小组?")){$.ajax({url:"outgroup.htm?"+param,success:function(data){if(data>0){var pageNo=$("#page").val();page(pageNo)}else{$("#message").html("退出小组失败");dia1(1)}}})}}function page(page){$("#page").val(page);$("#page_groupCategoryId").val($("#groupTypeId").val());$("#group_page_form").submit()}function groupSort(sort){$("#sort").val(sort);document.group_sort_form.submit()};