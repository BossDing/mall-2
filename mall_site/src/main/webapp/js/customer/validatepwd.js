$(function(){var checkedUsing=$("#checkedUsing").val();if(checkedUsing=="0"){$(".code_tip").show();$(".code_tip").html("验证码错误").css("color","#dd6330")}$("#checkCodeA").click(function(){$("#checkCodeImg").click()});$("#pwd").focus(function(){$(this).parent().find(".vd_tip").show().html("请输入登录密码").css("color","#dd6330")});$("#pwd").blur(function(){$(this).parent().find(".vd_tip").hide().html("登录密码错误").css("color","#dd6330")});$("#npwd").focus(function(){$(this).parent().find(".vd_tip").show().html("请输入登录密码").css("color","#dd6330")});$("#npwd").blur(function(){$(this).parent().find(".vd_tip").hide().html("密码格式不正确,请输入6-20位长度的密码!").css("color","#dd6330")});$("#repwd").focus(function(){$(this).parent().find(".ne_tips").show().html("请再次输入登录密码").css("color","#dd6330")});$("#repwd").blur(function(){checkRePwd()});$("#code").focus(function(){$(this).parent().find(".vd_tip").show().html("请输入验证码").css("color","#dd6330")});$("#code").blur(function(){$(this).parent().find(".vd_tip").hide().html("验证码错误").css("color","#dd6330")});$("#mcode").focus(function(){$(this).parent().find(".resend").show().html("请输入短信验证码").css("color","#dd6330")});$("#mcode").blur(function(){$(this).parent().find(".resend").hide().html("短信验证码错误").css("color","#dd6330")});$("#mobile").focus(function(){$(this).next().next().show().html("请填写正确的手机号码，我们将免费把校验码发送到您的手机")});$("#mobile").blur(function(){$(this).next().html("发送短信验证码");if(checkMobile()){$(this).next().removeAttr("disabled");$(".mobile_tip").html("")}});$("#email").focus(function(){$(this).next().show().html("请填写您常用的邮箱").css("color","#dd6330")});$("#email").blur(function(){$(this).next().hide().html("&nbsp;").css("color","#dd6330");checkEmail()});$(".m_tip").hide();$(".timeleft").css("color","#e4393c");$(".timeleft").css("font-weight","bold")});function modifyPwd(type){if(!checkPwd()){return false}if(!checkCurrentPwd()){return false}if(!checkCurrentCode()){return false}$("#reirectpem").submit()}function modifyMobile(type){if(!checkMCode()){return}if(!checkCurrentCode()){return}var res=0;var checkCode=$("#mcode").val();$.ajax({url:"getMCode.htm?code="+checkCode,context:document.body,async:false,success:function(data){res=data}});if(res==1){$(".mcode_tip").hide();$(".mcode_tip").html("请输入短信验证码").css("color","#dd6330")}else{if(res==-1){$(".mcode_tip").show();$(".mcode_tip").html("短信验证码已经失效").css("color","#dd6330");return}else{$(".mcode_tip").show();$(".mcode_tip").html("短信验证码错误").css("color","#dd6330");return}}location.href="reirectpem.html?type="+type+"&ut=mobile&code="+$("#code").val()+"&mcode="+checkCode+"&status=mobile"}function checkPwd(){var checkPayPwd=$("#pwd").val();if(checkPayPwd.length==0){$(".pwd_tip").show();$(".pwd_tip").html("请输入登录密码").css("color","#dd6330");return false}$(".pwd_tip").hide();$(".pwd_tip").html("登录密码错误").css("color","#dd6330");return true}function checkCurrentCode(){var checkCode=$("#code").val();if(checkCode==""||checkCode==null){$(".code_tip").show();$(".code_tip").html("请输入验证码").css("color","#dd6330");return false}else{return true}}function checkCurrentPwd(){var checkCode=$("#pwd").val();var flag=false;$.ajax({type:"post",url:"../checkcustomerpassword.htm",data:"password="+checkCode,async:false,success:function(data){if(data==1){$(".pwd_tip").hide();$(".pwd_tip").html("请输入登录密码").css("color","#dd6330");flag=true}else{$(".pwd_tip").show();$(".pwd_tip").html("登录密码错误").css("color","#dd6330");$("#checkCodeImg").click()}}});return flag}function checkMCode(){var checkCode=$("#mcode").val();if(checkCode!=""){$(".mcode_tip").hide();$(".mcode_tip").html("请输入短信验证码").css("color","#dd6330");return true}else{$(".mcode_tip").show();$(".mcode_tip").html("短信验证码错误").css("color","#dd6330");return false}}function checkCurrentMCode(){var checkCode=$("#mcode").val();$.ajax({url:"../getMCode.htm?code="+checkCode,context:document.body,async:false,success:function(data){if(data==1){$(".mcode_tip").hide();$(".mcode_tip").html("请输入短信验证码").css("color","#dd6330");return true}else{if(data==-1){$(".mcode_tip").show();$(".mcode_tip").html("短信验证码已经失效").css("color","#dd6330");return false}else{$(".mcode_tip").show();$(".mcode_tip").html("短信验证码错误").css("color","#dd6330");return false}}}})}function updatepem(type){var flag=true;if(type=="pwd"){if(!checkNewPwd()){flag=false;return}if(!checkRePwd()){flag=false;return}if(!checkCurrentCode()){flag=false;return false}if(flag){$("#upMobile").submit()}}else{if(type=="mobile"){if(!checkMobile()){flag=false;return}if(!checkMCode()){flag=false;return}if(!checkCurrentCode()){flag=false;return false}var res=0;var checkCode=$("#mcode").val();$.ajax({url:"getMCode.htm?code="+checkCode,context:document.body,async:false,success:function(data){res=data}});if(res==1){$(".mcode_tip").hide();$(".mcode_tip").html("请输入短信验证码").css("color","#dd6330")}else{if(res==-1){$(".mcode_tip").show();$(".mcode_tip").html("短信验证码已经失效").css("color","#dd6330");flag=false;return}else{$(".mcode_tip").show();$(".mcode_tip").html("短信验证码错误").css("color","#dd6330");flag=false;return}}if(flag){$("#upMobile").submit()
}}else{if(type=="email"){if(!checkEmail()){flag=false;return}}}}if(type=="email"){var datas="email="+$("#email").val()+"&csrFToken="+$("#CSRFToken").val();datas+="&type="+type+"&code="+$("#code").val();$.ajax({type:"post",url:"sendeamil.htm",data:datas,async:false,success:function(obj){if(obj==1){$("#sendValidEmail").attr("disabled","disabled");$("#upMobile").submit()}else{if(obj==2){$("#errorContent").html("验证码不能为空！");flag=false;dia(3)}else{if(obj==-1){flag=false;dia(4)}else{if(obj==3){flag=false;dia(2)}else{$("#errorContent").html("验证码不正确！");flag=false;dia(3)}}}}},error:function(){flag=false;dia(2)}});return}}function checkMobile(obj){var mobile=$("#mobile").val();if(!mobile){$("#m_tip").hide();$(".mobile_tip").show();$(".mobile_tip").html("请输入手机号").css("color","#dd633"+"0");$("#sendCode").attr("disabled","disabled");return false}var re=/^1{1}[3,4,5,8,7]{1}\d{9}$/;if(!re.test(mobile)){$("#m_tip").hide();$(".mobile_tip").show();$(".mobile_tip").html("请输入正确的手机号码").css("color","#dd6330");$("#sendCode").attr("disabled","disabled");return false}mFlag=false;if(obj!=1){var datass="mobile="+mobile;$.ajax({type:"post",url:"../checkmobileexist.htm",data:datass,async:false,success:function(obj){if(obj>0){$("#m_tip").hide();$(".mobile_tip").show();$("#sendCode").attr("disabled","disabled");$(".mobile_tip").html("检测到此手机已被使用,请更换!");mFlag=true;return false}},error:function(){dia(2);return false}})}if(mFlag){return false}return true}function getCode(){$("#sendCode").attr("disabled","disabled");if(!checkMobile(1)){return}var mFlag=false;var mobile=$("#mobile").val();var datas="moblie="+mobile;$.ajax({type:"get",url:"../sendcode.htm",data:datas,async:false,success:function(data){if(data==1){$(".timeleft").text(59);$("#m_tip").show();$(".mobile_tip").hide();setTimeout(countDown,1000);$("#mcode").removeAttr("disabled");$(".sub_btn").removeAttr("disabled");$("#mobile").attr("readonly","readonly");$("#sendCode").attr("disabled","disabled")}else{if(data==0){dia(2);$("#sendMobileCode").removeAttr("disabled")}else{if(data==-1){$("#m_tip").show();$(".mobile_tip").hide();$(".timeleft").text(59);if($(".timeleft").text()==59){$(".resend").text("");$("#m_tip").find(".resend").remove();$("#m_tip").find("br").remove();$(".resend").html("60秒内只能获取一次验证码,请稍后重试")}else{$(".resend").text("");$("#m_tip").find(".resend").remove();$("#m_tip").find("br").remove();$(".resend").html("60秒内只能获取一次验证码,请稍后重试")}}}}},error:function(){$("#submitCode").removeAttr("disabled");dia(2)}});function countDown(){var time=$(".timeleft").text();$(".timeleft").text(time-1);if(time==1){$("#m_tip").hide();$("#sendCode").removeAttr("disabled");$("#mobile").removeAttr("disabled")}else{setTimeout(countDown,1000)}}}function sendCode(){var mFlag=false;$("#sendCode").attr("disabled","disabled");$.ajax({type:"get",url:"../sendcodetovalidate.htm",async:true,success:function(data){if(data==1){$(".timeleft").text(59);$("#m_tip").show();$(".resend").text("");$(".mobile_tip").hide();setTimeout(countDown,1000);$("#mcode").removeAttr("disabled");$(".sub_btn").removeAttr("disabled");$("#sendCode").attr("disabled","disabled")}else{if(data==0){dia(2);$("#sendMobileCode").removeAttr("disabled")}else{if(data==-1){$("#m_tip").show();$(".mobile_tip").hide();$(".resend").text("");$(".resend").html("60秒内只能获取一次验证码,请稍后重试").show()}}}},error:function(){$("#submitCode").removeAttr("disabled");dia(2)}});function countDown(){var time=$(".timeleft").text();$(".timeleft").text(time-1);if(time==1){$("#m_tip").hide();$("#sendCode").removeAttr("disabled");$("#mobile").removeAttr("disabled")}else{setTimeout(countDown,1000)}}}function checkPass(obj){var is=0;if(obj.match(/([0-9])+/)){is++}if(obj.match(/([a-z])+/)){is++}if(obj.match(/([A-Z])+/)){is++}if(obj.match(/[^a-zA-Z0-9]+/)){is++}return is}function checkNewPwd(){var x=$("#npwd").val();var regS=/\s/g;if(regS.test(x)){$("#npwd").parent().find(".vd_tip").show().html("请勿输入空格!");$("#npwd").val("");return false}else{if(x.length<6||x.length>20){$("#npwd").parent().find(".vd_tip").show().html("密码格式不正确,请输入6-20位长度的密码!");return false}else{if(checkPass(x)<2){$("#npwd").parent().find(".vd_tip").show().html("密码必须是数字和英文字母组合!");return false}else{$("#npwd").parent().find(".vd_tip").show().html("");return true}}}}function checkRePwd(){var x=$("#npwd").val();var y=$("#repwd").val();if(y==""){$("#repwdtip").html("请再次输入登录密码").css("color","#dd6330");return false}if(x!=y){$("#repwdtip").html("两次输入的密码不一致").css("color","#dd6330");return false}$("#repwdtip").hide().html("请输入登录密码").css("color","gray");return true}function checkEmail(){var email=$("#email").val();if(!email){$(".email_tip").show();$(".email_tip").html("请输入您的常用邮箱");return false}var reg=/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/;if(email.replace(/[^\x00-\xff]/g,"**").length<=4||!reg.test(email)||email.length>50){$(".email_tip").show();$(".email_tip").html("邮箱格式不正确，请重新输入,长度在4-50之间");return false}if($("#e_hide").val()==email){$(".email_tip").show();$(".email_tip").html("检测到此邮箱为当前使用邮箱,请更换!");return false}var datas="email="+email,eFlag=false;
    $.ajax({type:"post",url:"../checkemailexist.htm",data:datas,async:false,success:function(obj){if(obj>0){$(".email_tip").show();$(".email_tip").html("检测到此邮箱已被使用,请更换!");eFlag=true;return false}},error:function(){dia(2)}});if(eFlag){return false}$(".email_tip").hide();$(".email_tip").html("");return true}function sendCheckIdEmail(type){if(!checkCurrentCode()){return}else{$.ajax({type:"post",url:"../validate/sendcheckidemail.htm",data:{"type":type,"code":$("#code").val()},async:false,success:function(obj){if(obj==1){$("#sendCode").attr("disabled","disabled");location.href="bindsucess.html?type="+type+"&code="+$("#code").val()}else{if(obj==-1){$(".code_tip").show();$(".code_tip").html("验证码输入错误").css("color","#dd6330");$("#checkCodeImg").click();return}dia(2)}},error:function(){dia(2)}})}};